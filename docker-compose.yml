# version: '3.8' # Docker Compose íŒŒì¼ í˜•ì‹ ë²„ì „

services:
  # ë°±ì—”ë“œ ì„œë¹„ìŠ¤ ì •ì˜
  backend-app:
    container_name: backend-app
    build:
      context: ./backend
      dockerfile: Dockerfile
    ports:
      - "8080:8080"
    networks:
      - my-app-network
    # ğŸš¨ ì—¬ê¸°ê°€ ìˆ˜ì •/ì¶”ê°€ëœ ë¶€ë¶„ì…ë‹ˆë‹¤!
    environment:
      # ìœ„ì—ì„œ ë°œìƒí•œ ì—ëŸ¬ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ allowPublicKeyRetrieval=true ì˜µì…˜ì„ ì¶”ê°€í•©ë‹ˆë‹¤.
      # DB í˜¸ìŠ¤íŠ¸ëŠ” localhostê°€ ì•„ë‹Œ host.docker.internalì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
      - SPRING_DATASOURCE_URL=jdbc:mysql://host.docker.internal:3306/lawvatardb?serverTimezone=UTC&useSSL=false&allowPublicKeyRetrieval=true
      - SPRING_DATASOURCE_USERNAME=root # ğŸ‘ˆ ì‹¤ì œ ë¡œì»¬ DB ì•„ì´ë””ë¡œ ë³€ê²½
      - SPRING_DATASOURCE_PASSWORD=root # ğŸ‘ˆ ì‹¤ì œ ë¡œì»¬ DB ë¹„ë°€ë²ˆí˜¸ë¡œ ë³€ê²½

  # í”„ë¡ íŠ¸ì—”ë“œ ì„œë¹„ìŠ¤ ì •ì˜
  frontend-app:
    container_name: frontend-app
    build:
      context: ./frontend
      dockerfile: Dockerfile
    ports:
      - "80:80" # ì›¹ ë¸Œë¼ìš°ì € ì ‘ì†ìš©
    depends_on:
      - backend-app # ë°±ì—”ë“œ ì„œë¹„ìŠ¤ê°€ ë¨¼ì € ì‹œì‘ë˜ë„ë¡ ì˜ì¡´ì„± ì„¤ì •
    networks:
      - my-app-network

# ì„œë¹„ìŠ¤ë“¤ì´ ì‚¬ìš©í•  ë„¤íŠ¸ì›Œí¬ ì •ì˜
networks:
  my-app-network:
    driver: bridge